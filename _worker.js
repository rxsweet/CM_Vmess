// 部署完成后在网址后面加上这个，获取订阅器默认节点，/auto

let mytoken= ['rx'];//快速订阅访问入口, 留空则不启动快速订阅

// 设置优选地址，不带端口号默认443，TLS订阅生成
let addresses = [
	'rxrx.cf.090227.xyz#自改域名',
];

// 设置优选地址api接口
let addressesapi = [
	'https://raw.githubusercontent.com/rxsweet/CM_Vmess/main/addressesapi.txt',//自用更新ip
	'https://raw.githubusercontent.com/rxsweet/CM_Vmess/main/addressesapi_自用扫描.txt',//自用扫描IP
	'https://raw.githubusercontent.com/rxsweet/CM_Vmess/main/goodDomain.txt',//自用域名
	//'https://raw.githubusercontent.com/cmliu/WorkerVless2sub/main/addressesapi.txt', //可参考内容格式 自行搭建。
	//'https://raw.githubusercontent.com/cmliu/WorkerVless2sub/main/addressesipv6api.txt', //IPv6优选内容格式 自行搭建。
];

// 设置优选地址，不带端口号默认80，noTLS订阅生成
let addressesnotls = [
	'cloudflare.cfgo.cc#域名',
];

// 设置优选noTLS地址api接口
let addressesnotlsapi = [
	'https://raw.githubusercontent.com/rxsweet/CM_Vmess/main/addressesapi.txt',//自用ip地址
	//'https://raw.githubusercontent.com/cmliu/CFcdnVmess2sub/main/addressesapi.txt',
];

let DLS = 8;//速度下限
let addressescsv = [
	//'https://raw.githubusercontent.com/cmliu/WorkerVless2sub/main/addressescsv.csv', //iptest测速结果文件。
];

let subconverter = "SUBAPI.fxxk.dedyn.io"; //在线订阅转换后端，目前使用肥羊的订阅转换功能。支持自建psub 可自行搭建https://github.com/bulianglin/psub
let subconfig = "https://raw.githubusercontent.com/rxsweet/all/main/githubTools/cfClashConfig.ini"; //订阅配置文件
//let subconfig = https://raw.githubusercontent.com/cmliu/ACL4SSR/main/Clash/config/ACL4SSR_Online_Full_MultiMode.ini"; //原订阅配置文件
let noTLS = 'true'; // false
let BotToken =''; //可以为空，或者@BotFather中输入/start，/newbot，并关注机器人
let ChatID =''; //可以为空，或者@userinfobot中获取，/start
let vmessLinks = [ //本地CFcdnVmess节点池
	//'vmess://ew0KICAidiI6ICIyIiwNCiAgInBzIjogIk5MIiwNCiAgImFkZCI6ICJjZi4wOTAyMjcueHl6IiwNCiAgInBvcnQiOiAiNDQzIiwNCiAgImlkIjogIjA2MTk1YjViLTM4MTUtNGEwNy05NmY3LTQ3ZWVmYmIxYjE0MyIsDQogICJhaWQiOiAiMCIsDQogICJzY3kiOiAiYXV0byIsDQogICJuZXQiOiAid3MiLA0KICAidHlwZSI6ICJub25lIiwNCiAgImhvc3QiOiAidXJueGV3enZoLnNpdGUiLA0KICAicGF0aCI6ICIva3dobXZ3cyIsDQogICJ0bHMiOiAidGxzIiwNCiAgInNuaSI6ICJ1cm54ZXd6dmguc2l0ZSIsDQogICJhbHBuIjogIiIsDQogICJmcCI6ICIiDQp9',
];
let vmessLinksURL = 'https://raw.githubusercontent.com/cmliu/CFcdnVmess2sub/main/vmesslinks';//CFcdnVmess节点池URL
//let vmessLinksURL = 'https://raw.githubusercontent.com/rxsweet/CM_Vmess/main/vmesslinks';//CFcdnVmess节点池URL
let proxyhosts = [//本地代理域名池
	//'ppfv2tl9veojd-maillazy.pages.dev',
];
let proxyhostsURL = 'https://raw.githubusercontent.com/cmliu/CFcdnVmess2sub/main/proxyhosts';//在线代理域名池URL
let FileName = 'rxVmess';
let SUBUpdateTime = 6; 
let total = 99;//PB
//let timestamp = now;
let timestamp = 4102329600000;//2099-12-31
const regex = /^(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}|\[.*\]):?(\d+)?#?(.*)?$/;
// 虚假uuid和hostname，用于发送给配置生成服务
let fakeUserID ;
let fakeHostName ;

/*Obfuscate-rx*/
const _0x177ecf=_0x3d9d;(function(_0x558495,_0x4a78fc){const _0x1350b4=_0x3d9d,_0x56495e=_0x558495();while(!![]){try{const _0x12aac5=-parseInt(_0x1350b4(0xfa))/0x1+parseInt(_0x1350b4(0x127))/0x2+parseInt(_0x1350b4(0x159))/0x3*(-parseInt(_0x1350b4(0x171))/0x4)+parseInt(_0x1350b4(0x174))/0x5+-parseInt(_0x1350b4(0x16a))/0x6+-parseInt(_0x1350b4(0x16f))/0x7*(parseInt(_0x1350b4(0x125))/0x8)+parseInt(_0x1350b4(0x120))/0x9;if(_0x12aac5===_0x4a78fc)break;else _0x56495e['push'](_0x56495e['shift']());}catch(_0x25cc54){_0x56495e['push'](_0x56495e['shift']());}}}(_0x81c5,0x24ab5));function utf8ToBase64(_0xc4c519){return btoa(unescape(encodeURIComponent(_0xc4c519)));}async function sendMessage(_0x859bd2,_0x412cd6,_0x4e343f=''){const _0x42b0ad=_0x3d9d;if(BotToken!==''&&ChatID!==''){let _0x38e961='';const _0x3fa911=await fetch(_0x42b0ad(0x152)+_0x412cd6+'?lang=zh-CN');if(_0x3fa911['status']==0xc8){const _0x9e7a=await _0x3fa911[_0x42b0ad(0x105)]();_0x38e961=_0x859bd2+_0x42b0ad(0x153)+_0x412cd6+'\x0a国家:\x20'+_0x9e7a['country']+_0x42b0ad(0x178)+_0x9e7a[_0x42b0ad(0x14a)]+_0x42b0ad(0x12e)+_0x9e7a[_0x42b0ad(0x102)]+_0x42b0ad(0x133)+_0x9e7a['as']+'\x0a'+_0x4e343f;}else _0x38e961=_0x859bd2+_0x42b0ad(0x153)+_0x412cd6+_0x42b0ad(0x132)+_0x4e343f;let _0x23763b=_0x42b0ad(0x175)+BotToken+'/sendMessage?chat_id='+ChatID+_0x42b0ad(0x15b)+encodeURIComponent(_0x38e961);return fetch(_0x23763b,{'method':_0x42b0ad(0x104),'headers':{'Accept':_0x42b0ad(0x14b),'Accept-Encoding':'gzip,\x20deflate,\x20br','User-Agent':_0x42b0ad(0xec)}});}}let MamaJustKilledAMan=[_0x177ecf(0xf6),_0x177ecf(0x15f),_0x177ecf(0x119)];async function getAddressesapi(_0x275ded){const _0x398364=_0x177ecf;if(!_0x275ded||_0x275ded[_0x398364(0x145)]===0x0)return[];let _0x20202c='';const _0x3d9d30=new AbortController(),_0x289b57=setTimeout(()=>{const _0x133d8c=_0x398364;_0x3d9d30[_0x133d8c(0x17c)]();},0x7d0);try{const _0x1b19a0=await Promise[_0x398364(0x151)](_0x275ded[_0x398364(0x136)](_0x72d3f2=>fetch(_0x72d3f2,{'method':_0x398364(0x104),'headers':{'Accept':_0x398364(0x14b),'User-Agent':_0x398364(0x137)},'signal':_0x3d9d30[_0x398364(0x176)]})[_0x398364(0x144)](_0x4f8b4c=>_0x4f8b4c['ok']?_0x4f8b4c['text']():Promise[_0x398364(0x148)]())));for(const _0x2985c7 of _0x1b19a0){if(_0x2985c7[_0x398364(0x143)]==='fulfilled'){const _0x3d8b6d=await _0x2985c7[_0x398364(0x163)];_0x20202c+=_0x3d8b6d+'\x0a';}}}catch(_0x543c50){console[_0x398364(0x140)](_0x543c50);}finally{clearTimeout(_0x289b57);}const _0x1f6b86=await ADD(_0x20202c);return _0x1f6b86;}async function getAddressescsv(_0x191b0c){const _0x1b1583=_0x177ecf;if(!addressescsv||addressescsv[_0x1b1583(0x145)]===0x0)return[];let _0xa35ed9=[];for(const _0x26bdf5 of addressescsv){try{const _0x30cab5=await fetch(_0x26bdf5);if(!_0x30cab5['ok']){console[_0x1b1583(0x140)]('获取CSV地址时出错:',_0x30cab5[_0x1b1583(0x143)],_0x30cab5[_0x1b1583(0x17a)]);continue;}const _0x2857c1=await _0x30cab5[_0x1b1583(0x17b)]();let _0x1040e2;_0x2857c1[_0x1b1583(0x156)]('\x0d\x0a')?_0x1040e2=_0x2857c1[_0x1b1583(0x10f)]('\x0d\x0a'):_0x1040e2=_0x2857c1[_0x1b1583(0x10f)]('\x0a');const _0x2e2b24=_0x1040e2[0x0][_0x1b1583(0x10f)](','),_0x4ec976=_0x2e2b24[_0x1b1583(0x130)]('TLS'),_0x32a28c=0x0,_0x585fb8=0x1,_0x140868=_0x4ec976+0x1;if(_0x4ec976===-0x1){console[_0x1b1583(0x140)](_0x1b1583(0x169));continue;}for(let _0x2a392b=0x1;_0x2a392b<_0x1040e2[_0x1b1583(0x145)];_0x2a392b++){const _0x34b3bd=_0x1040e2[_0x2a392b]['split'](','),_0x4238d8=_0x34b3bd[_0x1b1583(0x145)]-0x1;if(_0x34b3bd[_0x4ec976][_0x1b1583(0x13a)]()===_0x191b0c&&parseFloat(_0x34b3bd[_0x4238d8])>DLS){const _0x3e9d05=_0x34b3bd[_0x32a28c],_0x520f32=_0x34b3bd[_0x585fb8],_0x2e13f5=_0x34b3bd[_0x140868],_0x5d6298=_0x3e9d05+':'+_0x520f32+'#'+_0x2e13f5;_0xa35ed9[_0x1b1583(0x11e)](_0x5d6298);}}}catch(_0x411a2b){console[_0x1b1583(0x140)]('获取CSV地址时出错:',_0x411a2b);continue;}}return _0xa35ed9;}async function ADD(_0x3fa38e){const _0x5f4b72=_0x177ecf;var _0x17334d=_0x3fa38e[_0x5f4b72(0x106)](/[	|"'\r\n]+/g,',')[_0x5f4b72(0x106)](/,+/g,',');if(_0x17334d[_0x5f4b72(0x134)](0x0)==',')_0x17334d=_0x17334d[_0x5f4b72(0x11f)](0x1);if(_0x17334d[_0x5f4b72(0x134)](_0x17334d[_0x5f4b72(0x145)]-0x1)==',')_0x17334d=_0x17334d[_0x5f4b72(0x11f)](0x0,_0x17334d[_0x5f4b72(0x145)]-0x1);const _0x281d17=_0x17334d[_0x5f4b72(0x10f)](',');return _0x281d17;}function _0x81c5(){const _0x4f32ac=['\x22,\x0a\x22net\x22:\x20\x22ws\x22,\x0a\x22type\x22:\x20\x22none\x22,\x0a\x22host\x22:\x20\x22','port','https://','URL302','\x0a组织:\x20','some','indexOf','true','\x0a<tg-spoiler>','\x0aASN:\x20','charAt','URL','map','cmliu/WorkerVless2sub','join','LINK','toUpperCase','padStart','clash','#VMess订阅','test','\x22,\x0a\x22add\x22:\x20\x22','error','获取地址时出错:','parse','status','then','length','ADDNOTLS','\x22,\x0a\x22tls\x22:\x20\x22tls\x22,\x0a\x22sni\x22:\x20\x22','reject',';\x20filename=','city','text/html,application/xhtml+xml,application/xml;','concat','SUBAPI',';\x20total=','headers','\x22,\x0a\x22aid\x22:\x20\x22','allSettled','http://ip-api.com/json/','\x0aIP:\x20','scy',';\x20expire=','includes','encode','origin','406536QabTiH','ADDAPI','&parse_mode=HTML&text=','match','?cc=[vmess\x20name]&host=[your\x20host]&uuid=[your\x20uuid]&path=[your\x20path]\x0a\x09\x09\x09\x0a\x09\x09\x09\x0a\x09\x09\x09\x0a\x09\x09\x09\x0a\x09\x09\x09\x0a\x09\x09\x09\x0a\x09\x09\x09\x09\x0a\x09\x09\x09\x09https://github.com/cmliu/CFcdnVmess2sub\x0a\x09\x09\x09\x09','/sub','twitter','ADDCSV','nekobox','443','value','.xyz','\x0a\x09<!DOCTYPE\x20html>\x0a\x09<html>\x0a\x09<head>\x0a\x09<title>Welcome\x20to\x20nginx!</title>\x0a\x09<style>\x0a\x09\x09body\x20{\x0a\x09\x09\x09width:\x2035em;\x0a\x09\x09\x09margin:\x200\x20auto;\x0a\x09\x09\x09font-family:\x20Tahoma,\x20Verdana,\x20Arial,\x20sans-serif;\x0a\x09\x09}\x0a\x09</style>\x0a\x09</head>\x0a\x09<body>\x0a\x09<h1>Welcome\x20to\x20nginx!</h1>\x0a\x09<p>If\x20you\x20see\x20this\x20page,\x20the\x20nginx\x20web\x20server\x20is\x20successfully\x20installed\x20and\x0a\x09working.\x20Further\x20configuration\x20is\x20required.</p>\x0a\x09\x0a\x09<p>For\x20online\x20documentation\x20and\x20support\x20please\x20refer\x20to\x0a\x09<a\x20href=\x22http://nginx.org/\x22>nginx.org</a>.<br/>\x0a\x09Commercial\x20support\x20is\x20available\x20at\x0a\x09<a\x20href=\x22http://nginx.com/\x22>nginx.com</a>.</p>\x0a\x09\x0a\x09<p><em>Thank\x20you\x20for\x20using\x20nginx.</em></p>\x0a\x09</body>\x0a\x09</html>\x0a\x09',';\x20download=','redirect','toLowerCase','CSV文件缺少必需的字段','1434360QAsvRZ','\x22,\x0a\x22id\x22:\x20\x22','vmess://','\x0a\x09\x09\x09缺少必填参数：host\x20和\x20uuid\x0a\x09\x09\x09Missing\x20required\x20parameters:\x20host\x20and\x20uuid\x0a\x09\x09\x09پارامترهای\x20ضروری\x20وارد\x20نشده:\x20هاست\x20و\x20یوآی‌دی\x0a\x09\x09\x09\x0a\x09\x09\x09','digest','1791251rhrTAq','random','8mMsgKL','&emoji=true&list=false&tfo=false&scv=true&fdn=false&sort=false&new_name=true','\x0a<tg-spoiler>入口:\x20','323850COMPku','https://api.telegram.org/bot','signal','</tg-spoiler>\x0a域名:\x20','\x0a<tg-spoiler>城市:\x20','sni','statusText','text','abort','auto','Error:\x20','Mozilla/5.0\x20Chrome/90.0.4430.72','attachment;\x20filename*=utf-8\x27\x27','uuid','floor','DLS','UA:\x20','false','MD5','&insert=false&config=','message','telegram','getTime','null','trycloudflare','69269BcazIN','hostname','subconverter','country','subtle','host','path','ADD','org','TGID','get','json','replace','VMESS','ceil','startsWith','\x22,\x0a\x22alpn\x22:\x20\x22\x22,\x0a\x22fp\x22:\x20\x22\x22\x0a}','pathname','{\x0a\x22v\x22:\x20\x222\x22,\x0a\x22ps\x22:\x20\x22','Error\x20fetching\x20subconverterUrl:\x20','format','split','url','TOKEN','text/plain;\x20charset=utf-8','?lang=zh-CN','trim','upload=','sing-box','\x22,\x0a\x22scy\x22:\x20\x22','TRUE','miaoko','cf-workers-sub','ADDNOTLSAPI','NOTLS','/sub?target=singbox&url=','push','slice','5642388NovFed','\x22,\x0a\x22port\x22:\x20\x22','security','searchParams','search','8ZfxogZ','toString','587482yyEMIm','filter','singbox'];_0x81c5=function(){return _0x4f32ac;};return _0x81c5();}async function nginx(){const _0x54bfa0=_0x177ecf,_0x2ed715=_0x54bfa0(0x165);return _0x2ed715;}export default{async 'fetch'(_0x2e6a70,_0xbf646f){const _0x760c30=_0x177ecf;if(_0xbf646f[_0x760c30(0x111)])mytoken=await ADD(_0xbf646f[_0x760c30(0x111)]);BotToken=_0xbf646f['TGTOKEN']||BotToken,ChatID=_0xbf646f[_0x760c30(0x103)]||ChatID,subconverter=_0xbf646f[_0x760c30(0x14d)]||subconverter,subconfig=_0xbf646f['SUBCONFIG']||subconfig,FileName=_0xbf646f['SUBNAME']||FileName;const _0x148891=_0x2e6a70[_0x760c30(0x14f)]['get']('User-Agent')||_0x760c30(0xf8),_0x5b587b=_0x148891['toLowerCase'](),_0x1728e7=new URL(_0x2e6a70[_0x760c30(0x110)]),_0x40a485=_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)](_0x760c30(0x10e))?_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)](_0x760c30(0x10e))[_0x760c30(0x168)]():_0x760c30(0xf8);let _0x4c7a8c='',_0x133599='',_0x21db94='',_0x528b14='',_0x17d291='',_0xcff7d1='',_0x1d9283='',_0x1f3c29=Math[_0x760c30(0xef)]((timestamp-Date['now']())/timestamp*0x63*0x10000000000*0x400/0x2);if(_0xbf646f['UA'])MamaJustKilledAMan=MamaJustKilledAMan[_0x760c30(0x14c)](await ADD(_0xbf646f['UA']));const _0x345958=new Date(),_0x5b4a84=await MD5MD5(Math[_0x760c30(0x108)](_0x345958[_0x760c30(0xf7)]()));fakeUserID=_0x5b4a84['slice'](0x0,0x8)+'-'+_0x5b4a84[_0x760c30(0x11f)](0x8,0xc)+'-'+_0x5b4a84[_0x760c30(0x11f)](0xc,0x10)+'-'+_0x5b4a84[_0x760c30(0x11f)](0x10,0x14)+'-'+_0x5b4a84[_0x760c30(0x11f)](0x14),fakeHostName=_0x5b4a84[_0x760c30(0x11f)](0x6,0x9)+'.'+_0x5b4a84['slice'](0xd,0x13)+_0x760c30(0x164),total=total*0x10000000000*0x400;let _0x15061a=Math[_0x760c30(0xef)](timestamp/0x3e8);if(_0xbf646f[_0x760c30(0x139)])vmessLinks=await ADD(_0xbf646f['LINK']);else{if(_0xbf646f[_0x760c30(0x107)])vmessLinks=await ADD(_0xbf646f[_0x760c30(0x107)]);}if(_0xbf646f[_0x760c30(0x101)])addresses=await ADD(_0xbf646f[_0x760c30(0x101)]);if(_0xbf646f['ADDAPI'])addressesapi=await ADD(_0xbf646f[_0x760c30(0x15a)]);if(_0xbf646f['ADDNOTLS'])addressesnotls=await ADD(_0xbf646f[_0x760c30(0x146)]);if(_0xbf646f[_0x760c30(0x11b)])addressesnotlsapi=await ADD(_0xbf646f['ADDNOTLSAPI']);if(_0xbf646f['ADDCSV'])addressescsv=await ADD(_0xbf646f[_0x760c30(0x160)]);DLS=_0xbf646f[_0x760c30(0xf0)]||DLS;if(mytoken[_0x760c30(0x145)]>0x0&&mytoken[_0x760c30(0x12f)](_0x457862=>_0x1728e7[_0x760c30(0x10b)][_0x760c30(0x156)](_0x457862))){if(vmessLinksURL&&vmessLinks[_0x760c30(0x145)]==0x0)try{const _0x52dae1=await fetch(vmessLinksURL);if(!_0x52dae1['ok']){console[_0x760c30(0x140)](_0x760c30(0x141),_0x52dae1[_0x760c30(0x143)],_0x52dae1[_0x760c30(0x17a)]);return;}const _0x96df5b=await _0x52dae1[_0x760c30(0x17b)](),_0x12533f=_0x96df5b[_0x760c30(0x10f)]('\x0a'),_0x2e86c8=_0x12533f[_0x760c30(0x128)](_0x171fdb=>_0x171fdb[_0x760c30(0x109)](_0x760c30(0x16c)));vmessLinks=vmessLinks[_0x760c30(0x14c)](_0x2e86c8);}catch(_0x2fe50e){console[_0x760c30(0x140)](_0x760c30(0x141),_0x2fe50e);}const _0x27c2fb=[...new Set(vmessLinks)],_0x1f4f31=_0x27c2fb[Math['floor'](Math[_0x760c30(0x170)]()*_0x27c2fb[_0x760c30(0x145)])];noTLS=_0x760c30(0xf2);const _0x8a49c7=_0x1f4f31[_0x760c30(0x11f)](0x8),_0xded21a=atob(_0x8a49c7),_0x2cd64b=JSON[_0x760c30(0x142)](_0xded21a);_0x21db94=_0x2cd64b['id'],_0x17d291=_0x2cd64b['aid'],_0xcff7d1=_0x2cd64b[_0x760c30(0x154)];const _0x3fc09d=/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;_0x4c7a8c='未知';let _0x10645c=_0x760c30(0x152)+_0x2cd64b['host']+_0x760c30(0x113);if(_0x3fc09d[_0x760c30(0x13e)](_0x2cd64b['ps']))_0x10645c=_0x760c30(0x152)+_0x2cd64b['ps']+_0x760c30(0x113);const _0x512eb9=await fetch(_0x10645c);if(_0x512eb9[_0x760c30(0x143)]==0xc8){const _0x375be7=await _0x512eb9[_0x760c30(0x105)]();_0x4c7a8c=_0x375be7[_0x760c30(0xfd)]+'\x20'+_0x375be7[_0x760c30(0x14a)];}if(proxyhostsURL)try{const _0x64f81b=await fetch(proxyhostsURL);if(!_0x64f81b['ok']){console[_0x760c30(0x140)](_0x760c30(0x141),_0x64f81b[_0x760c30(0x143)],_0x64f81b[_0x760c30(0x17a)]);return;}const _0x27c46e=await _0x64f81b[_0x760c30(0x17b)](),_0x231bb3=_0x27c46e[_0x760c30(0x10f)]('\x0a'),_0x2e670f=_0x231bb3['filter'](_0x4f7683=>_0x4f7683[_0x760c30(0x114)]()!=='');proxyhosts=proxyhosts['concat'](_0x2e670f);}catch(_0x533d4f){console['error'](_0x760c30(0x141),_0x533d4f);}const _0x5b6ca1=[...new Set(proxyhosts)];_0x5b6ca1[_0x760c30(0x145)]>0x0?(_0x528b14='/'+_0x2cd64b['host']+':'+_0x2cd64b[_0x760c30(0x12b)]+_0x2cd64b[_0x760c30(0x100)],_0x133599=_0x5b6ca1[Math['floor'](Math[_0x760c30(0x170)]()*_0x5b6ca1[_0x760c30(0x145)])],_0x1d9283=_0x133599):(_0x528b14=_0x2cd64b['path'],_0x133599=_0x2cd64b[_0x760c30(0xff)],_0x1d9283=_0x133599),await sendMessage(_0x760c30(0x13d),_0x2e6a70[_0x760c30(0x14f)][_0x760c30(0x104)]('CF-Connecting-IP'),_0x760c30(0xf1)+_0x148891+_0x760c30(0x177)+_0x1728e7[_0x760c30(0xfb)]+_0x760c30(0x173)+(_0x1728e7[_0x760c30(0x10b)]+_0x1728e7['search'])+'</tg-spoiler>');}else{_0x133599=_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)](_0x760c30(0xff)),_0x21db94=_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)](_0x760c30(0xee)),_0x528b14=_0x1728e7['searchParams']['get'](_0x760c30(0x100))||'/?ed=2560',_0x528b14=_0x528b14[0x0]==='/'?_0x528b14:'/'+_0x528b14,_0x17d291=_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)]('alterid')||'0',_0xcff7d1=_0x1728e7['searchParams'][_0x760c30(0x104)](_0x760c30(0x122))||_0x760c30(0xea),_0x1d9283=_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)](_0x760c30(0x179))||_0x133599,_0x4c7a8c=_0x1728e7[_0x760c30(0x123)][_0x760c30(0x104)]('cc')||'未知';const _0x517612=_0x1728e7[_0x760c30(0x10b)][_0x760c30(0x106)](/^\/|\/$/g,'');if(_0x517612&&!_0x1728e7[_0x760c30(0x10b)][_0x760c30(0x156)](_0x760c30(0x15e))){const _0x1e1ae6=new URL(_0x760c30(0x12c)+_0x517612+_0x1728e7[_0x760c30(0x124)]);return fetch(new Request(_0x1e1ae6,_0x2e6a70));}else{if(!_0x1728e7[_0x760c30(0x10b)]['includes']('/sub')){const _0x5e0d1c=_0xbf646f['URL302']?_0x760c30(0x12d):_0xbf646f[_0x760c30(0x135)]?'URL':null;if(_0x5e0d1c){const _0x3805af=await ADD(_0xbf646f[_0x5e0d1c]),_0x41483c=_0x3805af[Math[_0x760c30(0xef)](Math[_0x760c30(0x170)]()*_0x3805af[_0x760c30(0x145)])];return _0x5e0d1c==='URL302'?Response[_0x760c30(0x167)](_0x41483c,0x12e):fetch(new Request(_0x41483c,_0x2e6a70));}return new Response(await nginx(),{'headers':{'Content-Type':'text/html;\x20charset=UTF-8'}});}}if(_0x4c7a8c=='未知'){let _0x2f274e=_0x760c30(0x152)+_0x1d9283+_0x760c30(0x113);const _0x194fdd=await fetch(_0x2f274e);if(_0x194fdd[_0x760c30(0x143)]==0xc8){const _0x429688=await _0x194fdd[_0x760c30(0x105)]();_0x4c7a8c=_0x429688['country']+'\x20'+_0x429688[_0x760c30(0x14a)];}}if(!_0x133599||!_0x21db94){const _0x4c4729=_0x1728e7[_0x760c30(0x158)]+_0x1728e7['pathname'],_0x405b97=_0x760c30(0x16d)+_0x4c4729+_0x760c30(0x15d);return new Response(_0x405b97,{'status':0x190,'headers':{'content-type':_0x760c30(0x112)}});}}if(_0x133599[_0x760c30(0x168)]()[_0x760c30(0x156)]('notls')||_0x133599[_0x760c30(0x168)]()[_0x760c30(0x156)](_0x760c30(0xf9)))noTLS=_0x760c30(0x131);noTLS=_0xbf646f[_0x760c30(0x11c)]||noTLS;let _0x47a054=generateFakeInfo(_0x1728e7['href'],_0x21db94,_0x133599);if(!_0x5b587b[_0x760c30(0x156)](_0x760c30(0xfc))&&MamaJustKilledAMan[_0x760c30(0x12f)](_0x436728=>_0x148891[_0x760c30(0x168)]()[_0x760c30(0x156)](_0x436728))&&MamaJustKilledAMan[_0x760c30(0x145)]>0x0){const _0x2035ad=_0xbf646f[_0x760c30(0x12d)]?_0x760c30(0x12d):_0xbf646f['URL']?_0x760c30(0x135):null;if(_0x2035ad){const _0x25bcf2=await ADD(_0xbf646f[_0x2035ad]),_0x37e325=_0x25bcf2[Math[_0x760c30(0xef)](Math['random']()*_0x25bcf2['length'])];return _0x2035ad==='URL302'?Response['redirect'](_0x37e325,0x12e):fetch(new Request(_0x37e325,_0x2e6a70));}return new Response(await nginx(),{'headers':{'Content-Type':'text/html;\x20charset=UTF-8'}});}else{if((_0x5b587b[_0x760c30(0x156)](_0x760c30(0x13c))||_0x40a485==='clash'&&!_0x5b587b[_0x760c30(0x156)](_0x760c30(0xfc)))&&!_0x5b587b[_0x760c30(0x156)](_0x760c30(0x161))&&!_0x5b587b['includes'](_0x760c30(0x11a)))_0x47a054=_0x760c30(0x12c)+subconverter+'/sub?target=clash&url='+encodeURIComponent(_0x47a054)+_0x760c30(0xf4)+encodeURIComponent(subconfig)+_0x760c30(0x172);else{if((_0x5b587b[_0x760c30(0x156)](_0x760c30(0x116))||_0x5b587b['includes']('singbox')||_0x40a485===_0x760c30(0x129)&&!_0x5b587b[_0x760c30(0x156)](_0x760c30(0xfc)))&&!_0x5b587b[_0x760c30(0x156)](_0x760c30(0x11a)))_0x47a054=_0x760c30(0x12c)+subconverter+_0x760c30(0x11d)+encodeURIComponent(_0x47a054)+_0x760c30(0xf4)+encodeURIComponent(subconfig)+_0x760c30(0x172);else{let _0x2a0b1a;if(noTLS=='true'){const _0x46084d=await getAddressesapi(addressesnotlsapi),_0x327a6b=await getAddressescsv('FALSE');addressesnotls=addressesnotls[_0x760c30(0x14c)](_0x46084d),addressesnotls=addressesnotls[_0x760c30(0x14c)](_0x327a6b);const _0x497b08=[...new Set(addressesnotls)];_0x2a0b1a=_0x497b08['map'](_0x22ec08=>{const _0x1f5d94=_0x760c30;let _0x59c4c1='80',_0x53c19a=_0x22ec08;const _0x3adbcf=_0x53c19a[_0x1f5d94(0x15c)](regex);if(!_0x3adbcf){if(_0x22ec08[_0x1f5d94(0x156)](':')&&_0x22ec08[_0x1f5d94(0x156)]('#')){const _0x4ab953=_0x22ec08['split'](':');_0x22ec08=_0x4ab953[0x0];const _0x281b32=_0x4ab953[0x1]['split']('#');_0x59c4c1=_0x281b32[0x0],_0x53c19a=_0x281b32[0x1];}else{if(_0x22ec08[_0x1f5d94(0x156)](':')){const _0x455205=_0x22ec08[_0x1f5d94(0x10f)](':');_0x22ec08=_0x455205[0x0],_0x59c4c1=_0x455205[0x1];}else{if(_0x22ec08[_0x1f5d94(0x156)]('#')){const _0x29fb89=_0x22ec08[_0x1f5d94(0x10f)]('#');_0x22ec08=_0x29fb89[0x0],_0x53c19a=_0x29fb89[0x1];}}}_0x53c19a[_0x1f5d94(0x156)](':')&&(_0x53c19a=_0x53c19a['split'](':')[0x0]);}else _0x22ec08=_0x3adbcf[0x1],_0x59c4c1=_0x3adbcf[0x2]||_0x59c4c1,_0x53c19a=_0x3adbcf[0x3]||_0x22ec08;const _0x15956a='{\x0a\x22v\x22:\x20\x222\x22,\x0a\x22ps\x22:\x20\x22'+_0x53c19a+'\x22,\x0a\x22add\x22:\x20\x22'+_0x22ec08+'\x22,\x0a\x22port\x22:\x20\x22'+_0x59c4c1+_0x1f5d94(0x16b)+_0x21db94+_0x1f5d94(0x150)+_0x17d291+'\x22,\x0a\x22scy\x22:\x20\x22'+_0xcff7d1+'\x22,\x0a\x22net\x22:\x20\x22ws\x22,\x0a\x22type\x22:\x20\x22none\x22,\x0a\x22host\x22:\x20\x22'+_0x133599+'\x22,\x0a\x22path\x22:\x20\x22'+_0x528b14+'\x22,\x0a\x22tls\x22:\x20\x22\x22,\x0a\x22sni\x22:\x20\x22\x22,\x0a\x22alpn\x22:\x20\x22\x22,\x0a\x22fp\x22:\x20\x22\x22\x0a}',_0x208b64=utf8ToBase64(_0x15956a),_0x4e0663='vmess://'+_0x208b64;return _0x4e0663;})[_0x760c30(0x138)]('\x0a');}const _0x5b6a03=await getAddressesapi(addressesapi),_0x289cfb=await getAddressescsv(_0x760c30(0x118));addresses=addresses[_0x760c30(0x14c)](_0x5b6a03),addresses=addresses['concat'](_0x289cfb);const _0x3a7008=[...new Set(addresses)],_0x335300=_0x3a7008[_0x760c30(0x136)](_0x2b9a6a=>{const _0x4e4065=_0x760c30;let _0x29882a=_0x4e4065(0x162),_0x2ee206=_0x2b9a6a;const _0x8860d3=_0x2ee206[_0x4e4065(0x15c)](regex);if(!_0x8860d3){if(_0x2b9a6a[_0x4e4065(0x156)](':')&&_0x2b9a6a[_0x4e4065(0x156)]('#')){const _0xd0451=_0x2b9a6a['split'](':');_0x2b9a6a=_0xd0451[0x0];const _0x393d53=_0xd0451[0x1][_0x4e4065(0x10f)]('#');_0x29882a=_0x393d53[0x0],_0x2ee206=_0x393d53[0x1];}else{if(_0x2b9a6a[_0x4e4065(0x156)](':')){const _0x47b77d=_0x2b9a6a[_0x4e4065(0x10f)](':');_0x2b9a6a=_0x47b77d[0x0],_0x29882a=_0x47b77d[0x1];}else{if(_0x2b9a6a['includes']('#')){const _0x201d62=_0x2b9a6a[_0x4e4065(0x10f)]('#');_0x2b9a6a=_0x201d62[0x0],_0x2ee206=_0x201d62[0x1];}}}_0x2ee206[_0x4e4065(0x156)](':')&&(_0x2ee206=_0x2ee206[_0x4e4065(0x10f)](':')[0x0]);}else _0x2b9a6a=_0x8860d3[0x1],_0x29882a=_0x8860d3[0x2]||_0x29882a,_0x2ee206=_0x8860d3[0x3]||_0x2b9a6a;const _0x490996=_0x4e4065(0x10c)+_0x2ee206+_0x4e4065(0x13f)+_0x2b9a6a+_0x4e4065(0x121)+_0x29882a+_0x4e4065(0x16b)+_0x21db94+_0x4e4065(0x150)+_0x17d291+_0x4e4065(0x117)+_0xcff7d1+_0x4e4065(0x12a)+_0x133599+'\x22,\x0a\x22path\x22:\x20\x22'+_0x528b14+_0x4e4065(0x147)+_0x1d9283+_0x4e4065(0x10a),_0x50f3b3=utf8ToBase64(_0x490996),_0x20dbfc=_0x4e4065(0x16c)+_0x50f3b3;return _0x20dbfc;})['join']('\x0a');let _0x89cea4=_0x335300;if(noTLS==_0x760c30(0x131))_0x89cea4+='\x0a'+_0x2a0b1a;const _0x32d5cf=btoa(_0x89cea4),_0x2df8c2=new Response(_0x32d5cf,{'headers':{'content-type':_0x760c30(0x112),'Profile-Update-Interval':''+SUBUpdateTime,'Subscription-Userinfo':_0x760c30(0x115)+_0x1f3c29+_0x760c30(0x166)+_0x1f3c29+_0x760c30(0x14e)+total+_0x760c30(0x155)+_0x15061a}});return _0x2df8c2;}}}try{const _0x47b895=await fetch(_0x47a054);if(!_0x47b895['ok'])throw new Error(_0x760c30(0x10d)+_0x47b895[_0x760c30(0x143)]+'\x20'+_0x47b895['statusText']);let _0xc1ada6=await _0x47b895[_0x760c30(0x17b)]();return _0xc1ada6=revertFakeInfo(_0xc1ada6,_0x21db94,_0x133599),new Response(_0xc1ada6,{'headers':{'Content-Disposition':_0x760c30(0xed)+encodeURIComponent(FileName)+_0x760c30(0x149)+FileName,'content-type':_0x760c30(0x112),'Profile-Update-Interval':''+SUBUpdateTime,'Subscription-Userinfo':_0x760c30(0x115)+_0x1f3c29+_0x760c30(0x166)+_0x1f3c29+_0x760c30(0x14e)+total+_0x760c30(0x155)+_0x15061a}});}catch(_0x2bc013){return new Response(_0x760c30(0xeb)+_0x2bc013[_0x760c30(0xf5)],{'status':0x1f4,'headers':{'content-type':_0x760c30(0x112)}});}}};async function MD5MD5(_0x24bbe7){const _0x13017b=_0x177ecf,_0x17af93=new TextEncoder(),_0x27d65e=await crypto[_0x13017b(0xfe)][_0x13017b(0x16e)](_0x13017b(0xf3),_0x17af93[_0x13017b(0x157)](_0x24bbe7)),_0x21caa4=Array['from'](new Uint8Array(_0x27d65e)),_0x43e276=_0x21caa4[_0x13017b(0x136)](_0x20e7f8=>_0x20e7f8[_0x13017b(0x126)](0x10)[_0x13017b(0x13b)](0x2,'0'))[_0x13017b(0x138)](''),_0x574767=await crypto[_0x13017b(0xfe)][_0x13017b(0x16e)](_0x13017b(0xf3),_0x17af93[_0x13017b(0x157)](_0x43e276[_0x13017b(0x11f)](0x7,0x1b))),_0x1cba60=Array['from'](new Uint8Array(_0x574767)),_0x484513=_0x1cba60[_0x13017b(0x136)](_0x41cc11=>_0x41cc11[_0x13017b(0x126)](0x10)[_0x13017b(0x13b)](0x2,'0'))[_0x13017b(0x138)]('');return _0x484513[_0x13017b(0x168)]();}function revertFakeInfo(_0x235e88,_0x3518f7,_0x36c6a7){const _0x1f09c0=_0x177ecf;return _0x235e88=_0x235e88['replace'](new RegExp(fakeUserID,'g'),_0x3518f7)[_0x1f09c0(0x106)](new RegExp(fakeHostName,'g'),_0x36c6a7),_0x235e88;}function _0x3d9d(_0x20f4da,_0x551ace){const _0x81c5fd=_0x81c5();return _0x3d9d=function(_0x3d9d84,_0x187898){_0x3d9d84=_0x3d9d84-0xea;let _0xcd1c1b=_0x81c5fd[_0x3d9d84];return _0xcd1c1b;},_0x3d9d(_0x20f4da,_0x551ace);}function generateFakeInfo(_0x3c7d3d,_0x331b90,_0x41fa76){const _0x3bd1ec=_0x177ecf;return _0x3c7d3d=_0x3c7d3d['replace'](new RegExp(_0x331b90,'g'),fakeUserID)[_0x3bd1ec(0x106)](new RegExp(_0x41fa76,'g'),fakeHostName),_0x3c7d3d;}
